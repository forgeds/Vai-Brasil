<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle de Parcelas - Firebase 1</title>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>Cadastro de Contrato</h2>
  <input type="text" id="nome" placeholder="Nome">
  <input type="text" id="cpf" placeholder="CPF">
  <input type="text" id="contrato" placeholder="Número do Contrato">
  <input type="number" id="valor" placeholder="Valor da Parcela">
  <input type="date" id="vencimento">
  <input type="number" id="parcelas" placeholder="Quantidade de Parcelas">
  <button onclick="adicionarPagamento()">Adicionar Contrato</button>

  <h2>Lista de Contratos</h2>
  <ul id="listaContratos"></ul>

  <script>
    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCkwjUH12X4NUfXxt6pDh5D-4MYsKdbm9Y",
      authDomain: "vai-brasil-2f7ec.firebaseapp.com",
      databaseURL: "https://vai-brasil-2f7ec-default-rtdb.firebaseio.com",
      projectId: "vai-brasil-2f7ec",
      storageBucket: "vai-brasil-2f7ec.appspot.com",
      messagingSenderId: "480537313713",
      appId: "1:480537313713:web:e94996796a1c2a51c27d90"
    };

    // Inicializa Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    console.log("Firebase inicializado com sucesso");

    function adicionarPagamento() {
      const nome = document.getElementById('nome').value;
      const cpf = document.getElementById('cpf').value;
      const contrato = document.getElementById('contrato').value;
      const valor = parseFloat(document.getElementById('valor').value);
      const vencimento = document.getElementById('vencimento').value;
      const parcelas = parseInt(document.getElementById('parcelas').value);

      if (!nome || !cpf || !contrato || isNaN(valor) || !vencimento || isNaN(parcelas)) {
        alert('Preencha todos os campos corretamente!');
        return;
      }

      const contratoId = Date.now().toString();
      db.collection("contratos").doc(contratoId).set({
        nome, cpf, contrato, valor, vencimento, parcelas
      }).then(() => {
        alert("Contrato salvo com sucesso!");
        listarContratos();
      }).catch(error => console.error("Erro ao salvar: ", error));
    }

    function listarContratos() {
      const lista = document.getElementById('listaContratos');
      lista.innerHTML = '';
      db.collection("contratos").get().then(snapshot => {
        snapshot.forEach(doc => {
          let item = document.createElement('li');
          item.textContent = `${doc.data().contrato} - ${doc.data().nome} - R$ ${doc.data().valor}`;
          lista.appendChild(item);
        });
      }).catch(error => console.error("Erro ao listar contratos: ", error));
    }

    listarContratos();
  </script>
</body>
</html>
